# IDS agent

RAG 기반 IDS 분석 에이전트

※ 중요!! ********************************************************************************************************
    업로드 시 OpenAI API 키를 빼고 업로드했습니다! LLM 분석 보고서를 출력하려면 config.py에 API 키 입력이 필요합니다! 
    *************************************************************************************************************

## 동작 방식
snort에서 생성한 이벤트 로그를 자동으로 수집하여 아래의 세 단계를 거친다.

1. 1차 분석
    사전 학습된 모델이 이벤트 로그를 분류하여 공격 유형을 예측하고 신뢰도를 평가해서 RAG 단계로 전달한다.
2. RAG 연관 지식 검색
    1단계에서 추출된 공격 유형 및 로그 텍스트를 입력하면 MITRE ATT&CK, CVE 등 보안 데이터셋 벡터 인덱스 검색, 관련 문서 및 기술 ID를 조회하여 공격 관련 근거 컨텍스트를 출력한다.
3. LLM 기반 심층 분석 및 보고서 생성
    LLM이 위 결과를 바탕으로 공격 개요, 근거, 대응 방안을 포함한 요약 보고서를 작성하여 출력하고 JSON 파일로 저장한다.

## agent 전체 흐름
[Snort Log]
     ↓
[ML Model]
     ↓
     {attack_type, confidence}
     ↓
[RAG Search]
     ↓
     {MITRE, CVE context}
     ↓
[LLM Report]
     ↓
[JSON Output]
